#!/usr/bin/env ruby

begin
  require 'plot_statistics'
rescue LoadError
  require 'rubygems'
  gem     'plot_statistics'
  require 'plot_statistics'
end

ARGV.each do |filename|
  file = File.new(filename)
  lines = file.readlines
  file.close

  puts "\n"
  puts '##########################'
  puts "#   #{filename}"
  puts '##########################'
  puts "\n"

  clams = lines.map do |line|
    x, y = line.strip.split("\t")
    PlotStatistics::Clam.new(:x => x.to_i, :y => y.to_i)
  end

  actual_plot = PlotStatistics::ClamPlot.new(clams)
  monte_carlo = PlotStatistics::MonteCarlo.new(actual_plot.number_of_clams)

  output_filename = filename + '.result.csv'
  PlotStatistics::Output.new(:clam_plot => actual_plot, :monte_carlo => monte_carlo).write_to_file(output_filename)
end